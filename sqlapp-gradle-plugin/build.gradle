plugins {
	id "com.gradle.plugin-publish" version "0.20.0"
    id "com.github.joschi.licenser" version "0.6.1"
	id 'groovy-gradle-plugin'
}
apply plugin: 'groovy'
apply plugin: 'com.gradle.plugin-publish'
apply from: '../buildSrc/license.gradle'

configurations {
	all*.exclude module: 'commons-logging'
	all*.exclude module: 'log4j'
	all*.exclude group: 'ch.qos.logback'
	all*.exclude group: 'org.slf4j'
}


dependencies {
	//logging
	//compile 'ch.qos.logback:logback-classic:1.2.3'
//	[
//		'slf4j-api',
//		'jcl-over-slf4j'
//	].each { name -> compile "org.slf4j:${name}:1.7.25" }
	//JDBC
	api group: 'com.zaxxer', name: 'HikariCP', version: '5.0.1'
	
	api gradleApi()
//	compile ('org.gradle:gradle-core:4.9'){
//		exclude group:'org.codehaus.groovy'
//	}
//    api localGroovy()
//	compile group: 'org.codehaus.groovy', name: 'groovy-all', version: '3.0.9'
//	compile project(':sqlapp-core')
	api (project(':sqlapp-command')){
		exclude group:'ch.qos.logback'
		exclude group:'org.slf4j'
	}
//	api (group: 'com.sqlapp', name: 'sqlapp-command', version: '0.12.28'){
//		exclude group:'ch.qos.logback'
//		exclude group:'org.slf4j'
//	}

	//testCompile group: 'org.codehaus.groovy', name: 'groovy-all', version: '2.3.6'
//	testCompile("org.spockframework:spock-core:1.1-groovy-2.4-rc-2"){
//		exclude group: 'org.codehaus.groovy', module: 'groovy-all'
//		exclude group:'org.codehaus.groovy'
//	}
	
	api group: 'javax.activation', name: 'activation', version: '1.1.1'

	// https://mvnrepository.com/artifact/org.codehaus.groovy/groovy-yaml
	api ('org.codehaus.groovy:groovy-yaml:3.0.9'){
		exclude group:'org.codehaus.groovy', module:'groovy'
	}

	testImplementation group: 'org.hsqldb', name: 'hsqldb', version: '2.4.0'
	testImplementation project(':sqlapp-core-hsql')
	
	//JUnit
	[
		'api',
		'engine',
		'params'
	].each { name -> api "org.junit.jupiter:junit-jupiter-${name}:5.8.2" }
	testImplementation group: 'org.junit.platform', name: 'junit-platform-launcher', version: "1.8.2"
}

pluginBundle {
	website = "${scmUrl}"
	vcsUrl = "${scmConnection}"
	description = 'Sqlapp Gradle Plugin'
	version = project.version
	tags = ['DB', 'ER diagram', 'schema', 'migration', 'diff']

	plugins {
		'sqlappPlugin' {
			id = 'com.sqlapp.db'
			displayName = "${description}"
		}
	}
}

generateMetadataFileForMavenJavaPublication.dependsOn validatePlugins
